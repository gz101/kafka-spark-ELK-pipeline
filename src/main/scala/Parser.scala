// import org.apache.spark.sql.{SparkSession}
// import org.apache.spark.sql.types._
// import org.apache.spark.sql.functions._

// object Parser {
//   val sampleJson = 
//     """
//     {"request_type": "water_standpipe", "length": 136, "RL_units": "AHD (m)", "timezone": "UTC", "items": [{"borehole_number": "BH-4308", "instrument": "water_standpipe", "surface_level": 94.38, "northing": 5812457, "easting": 316517, "water_level": 94.36, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2813", "instrument": "water_standpipe", "surface_level": 99.52, "northing": 5814816, "easting": 320571, "water_level": 90.86, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-756", "instrument": "water_standpipe", "surface_level": 78.92, "northing": 5810823, "easting": 318988, "water_level": 74.32, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4722", "instrument": "water_standpipe", "surface_level": 84.8, "northing": 5813908, "easting": 321075, "water_level": 82.79, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-11", "instrument": "water_standpipe", "surface_level": 80.39, "northing": 5813467, "easting": 323593, "water_level": 81.67, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1359", "instrument": "water_standpipe", "surface_level": 103.0, "northing": 5812554, "easting": 322988, "water_level": 95.56, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-957", "instrument": "water_standpipe", "surface_level": 114.15, "northing": 5810126, "easting": 322097, "water_level": 107.19, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8901", "instrument": "water_standpipe", "surface_level": 87.0, "northing": 5810070, "easting": 318174, "water_level": 79.84, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3626", "instrument": "water_standpipe", "surface_level": 77.23, "northing": 5815626, "easting": 321251, "water_level": 77.5, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8847", "instrument": "water_standpipe", "surface_level": 118.06, "northing": 5812046, "easting": 316124, "water_level": 114.81, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-6295", "instrument": "water_standpipe", "surface_level": 111.59, "northing": 5812099, "easting": 323547, "water_level": 109.38, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2934", "instrument": "water_standpipe", "surface_level": 101.21, "northing": 5811946, "easting": 320769, "water_level": 95.35, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3163", "instrument": "water_standpipe", "surface_level": 106.85, "northing": 5811552, "easting": 317381, "water_level": 106.52, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5185", "instrument": "water_standpipe", "surface_level": 109.82, "northing": 5811180, "easting": 321676, "water_level": 103.08, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3892", "instrument": "water_standpipe", "surface_level": 93.92, "northing": 5813625, "easting": 321749, "water_level": 84.68, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7923", "instrument": "water_standpipe", "surface_level": 102.39, "northing": 5815330, "easting": 316536, "water_level": 101.61, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5458", "instrument": "water_standpipe", "surface_level": 94.3, "northing": 5815262, "easting": 324687, "water_level": 92.93, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4063", "instrument": "water_standpipe", "surface_level": 91.51, "northing": 5810828, "easting": 320989, "water_level": 87.03, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-994", "instrument": "water_standpipe", "surface_level": 95.3, "northing": 5811136, "easting": 316834, "water_level": 85.59, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4986", "instrument": "water_standpipe", "surface_level": 107.45, "northing": 5810671, "easting": 317389, "water_level": 97.61, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9042", "instrument": "water_standpipe", "surface_level": 91.28, "northing": 5813839, "easting": 324766, "water_level": 87.7, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9603", "instrument": "water_standpipe", "surface_level": 75.07, "northing": 5814856, "easting": 321134, "water_level": 73.78, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4204", "instrument": "water_standpipe", "surface_level": 99.87, "northing": 5814866, "easting": 324393, "water_level": 97.93, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8265", "instrument": "water_standpipe", "surface_level": 96.37, "northing": 5811819, "easting": 319589, "water_level": 87.03, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1442", "instrument": "water_standpipe", "surface_level": 119.51, "northing": 5810674, "easting": 318869, "water_level": 116.99, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7808", "instrument": "water_standpipe", "surface_level": 89.42, "northing": 5812668, "easting": 323466, "water_level": 80.44, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-6245", "instrument": "water_standpipe", "surface_level": 94.66, "northing": 5815602, "easting": 319841, "water_level": 88.78, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3659", "instrument": "water_standpipe", "surface_level": 77.15, "northing": 5813883, "easting": 323726, "water_level": 77.03, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-593", "instrument": "water_standpipe", "surface_level": 93.75, "northing": 5810465, "easting": 321774, "water_level": 88.94, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5361", "instrument": "water_standpipe", "surface_level": 94.68, "northing": 5812554, "easting": 322927, "water_level": 91.58, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9377", "instrument": "water_standpipe", "surface_level": 80.89, "northing": 5813745, "easting": 317345, "water_level": 73.82, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2362", "instrument": "water_standpipe", "surface_level": 77.99, "northing": 5815913, "easting": 321162, "water_level": 74.33, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-731", "instrument": "water_standpipe", "surface_level": 114.81, "northing": 5813792, "easting": 321256, "water_level": 116.04, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1376", "instrument": "water_standpipe", "surface_level": 116.12, "northing": 5811598, "easting": 320382, "water_level": 115.05, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8158", "instrument": "water_standpipe", "surface_level": 97.89, "northing": 5811805, "easting": 319154, "water_level": 95.53, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2952", "instrument": "water_standpipe", "surface_level": 113.25, "northing": 5810547, "easting": 321213, "water_level": 106.78, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4818", "instrument": "water_standpipe", "surface_level": 112.62, "northing": 5812079, "easting": 323869, "water_level": 107.14, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4107", "instrument": "water_standpipe", "surface_level": 112.17, "northing": 5811309, "easting": 316724, "water_level": 105.82, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2231", "instrument": "water_standpipe", "surface_level": 105.71, "northing": 5810508, "easting": 317210, "water_level": 100.81, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-766", "instrument": "water_standpipe", "surface_level": 79.32, "northing": 5812008, "easting": 320495, "water_level": 73.03, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2401", "instrument": "water_standpipe", "surface_level": 119.7, "northing": 5813027, "easting": 321547, "water_level": 120.16, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-491", "instrument": "water_standpipe", "surface_level": 93.17, "northing": 5815928, "easting": 316539, "water_level": 85.44, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7121", "instrument": "water_standpipe", "surface_level": 81.35, "northing": 5814525, "easting": 324296, "water_level": 74.57, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7009", "instrument": "water_standpipe", "surface_level": 84.29, "northing": 5810108, "easting": 320326, "water_level": 74.72, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2933", "instrument": "water_standpipe", "surface_level": 101.27, "northing": 5814665, "easting": 320202, "water_level": 102.79, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7159", "instrument": "water_standpipe", "surface_level": 112.42, "northing": 5815938, "easting": 324511, "water_level": 110.27, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8544", "instrument": "water_standpipe", "surface_level": 102.88, "northing": 5814866, "easting": 316477, "water_level": 103.76, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3146", "instrument": "water_standpipe", "surface_level": 77.5, "northing": 5810368, "easting": 320439, "water_level": 78.17, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8470", "instrument": "water_standpipe", "surface_level": 118.85, "northing": 5811204, "easting": 317677, "water_level": 116.46, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4799", "instrument": "water_standpipe", "surface_level": 118.21, "northing": 5814687, "easting": 323650, "water_level": 108.24, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4296", "instrument": "water_standpipe", "surface_level": 108.69, "northing": 5811482, "easting": 322408, "water_level": 104.17, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7322", "instrument": "water_standpipe", "surface_level": 76.23, "northing": 5815498, "easting": 320024, "water_level": 66.81, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9758", "instrument": "water_standpipe", "surface_level": 76.26, "northing": 5813938, "easting": 322262, "water_level": 76.59, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1302", "instrument": "water_standpipe", "surface_level": 87.79, "northing": 5813352, "easting": 319687, "water_level": 83.88, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5505", "instrument": "water_standpipe", "surface_level": 86.55, "northing": 5811867, "easting": 320940, "water_level": 80.07, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7672", "instrument": "water_standpipe", "surface_level": 101.16, "northing": 5810964, "easting": 323321, "water_level": 91.23, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4138", "instrument": "water_standpipe", "surface_level": 113.73, "northing": 5811253, "easting": 316552, "water_level": 110.45, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2074", "instrument": "water_standpipe", "surface_level": 91.26, "northing": 5813564, "easting": 319048, "water_level": 85.79, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9215", "instrument": "water_standpipe", "surface_level": 93.35, "northing": 5811892, "easting": 319622, "water_level": 87.56, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3364", "instrument": "water_standpipe", "surface_level": 99.18, "northing": 5814731, "easting": 319135, "water_level": 100.79, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3418", "instrument": "water_standpipe", "surface_level": 101.6, "northing": 5815005, "easting": 319443, "water_level": 99.14, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-833", "instrument": "water_standpipe", "surface_level": 82.13, "northing": 5814068, "easting": 322469, "water_level": 81.17, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5244", "instrument": "water_standpipe", "surface_level": 98.68, "northing": 5810006, "easting": 320111, "water_level": 96.97, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-669", "instrument": "water_standpipe", "surface_level": 109.29, "northing": 5812400, "easting": 321534, "water_level": 103.37, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9505", "instrument": "water_standpipe", "surface_level": 114.33, "northing": 5813227, "easting": 323857, "water_level": 110.42, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5700", "instrument": "water_standpipe", "surface_level": 106.8, "northing": 5813842, "easting": 323631, "water_level": 101.66, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9001", "instrument": "water_standpipe", "surface_level": 104.73, "northing": 5815589, "easting": 321359, "water_level": 100.27, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1204", "instrument": "water_standpipe", "surface_level": 78.98, "northing": 5812158, "easting": 317400, "water_level": 74.81, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7615", "instrument": "water_standpipe", "surface_level": 118.4, "northing": 5810885, "easting": 324176, "water_level": 114.08, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3090", "instrument": "water_standpipe", "surface_level": 76.22, "northing": 5815563, "easting": 318008, "water_level": 76.54, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4745", "instrument": "water_standpipe", "surface_level": 87.09, "northing": 5811725, "easting": 319196, "water_level": 80.79, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5849", "instrument": "water_standpipe", "surface_level": 107.4, "northing": 5812489, "easting": 316073, "water_level": 107.28, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3485", "instrument": "water_standpipe", "surface_level": 91.47, "northing": 5814850, "easting": 324252, "water_level": 86.23, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-6509", "instrument": "water_standpipe", "surface_level": 119.42, "northing": 5814796, "easting": 322612, "water_level": 110.6, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7474", "instrument": "water_standpipe", "surface_level": 118.55, "northing": 5815363, "easting": 320666, "water_level": 112.58, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3474", "instrument": "water_standpipe", "surface_level": 92.68, "northing": 5810359, "easting": 316338, "water_level": 89.82, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8541", "instrument": "water_standpipe", "surface_level": 106.56, "northing": 5815884, "easting": 318307, "water_level": 97.56, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3137", "instrument": "water_standpipe", "surface_level": 100.8, "northing": 5814544, "easting": 317628, "water_level": 95.98, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-695", "instrument": "water_standpipe", "surface_level": 77.01, "northing": 5810753, "easting": 322973, "water_level": 67.12, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-299", "instrument": "water_standpipe", "surface_level": 106.73, "northing": 5813382, "easting": 321955, "water_level": 104.42, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-814", "instrument": "water_standpipe", "surface_level": 116.65, "northing": 5813105, "easting": 319414, "water_level": 115.67, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2378", "instrument": "water_standpipe", "surface_level": 109.1, "northing": 5814269, "easting": 322032, "water_level": 108.42, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5866", "instrument": "water_standpipe", "surface_level": 84.94, "northing": 5812235, "easting": 324737, "water_level": 81.31, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-6426", "instrument": "water_standpipe", "surface_level": 99.6, "northing": 5813785, "easting": 320584, "water_level": 97.41, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5164", "instrument": "water_standpipe", "surface_level": 116.36, "northing": 5814159, "easting": 324704, "water_level": 109.21, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5288", "instrument": "water_standpipe", "surface_level": 112.41, "northing": 5810859, "easting": 324006, "water_level": 105.32, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8031", "instrument": "water_standpipe", "surface_level": 105.95, "northing": 5810837, "easting": 316171, "water_level": 96.44, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4454", "instrument": "water_standpipe", "surface_level": 113.68, "northing": 5814368, "easting": 324555, "water_level": 113.61, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-250", "instrument": "water_standpipe", "surface_level": 79.38, "northing": 5815770, "easting": 319569, "water_level": 80.22, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5437", "instrument": "water_standpipe", "surface_level": 112.52, "northing": 5813911, "easting": 322197, "water_level": 107.35, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7193", "instrument": "water_standpipe", "surface_level": 99.12, "northing": 5812226, "easting": 323556, "water_level": 90.78, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4237", "instrument": "water_standpipe", "surface_level": 117.33, "northing": 5815659, "easting": 322295, "water_level": 107.44, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-6706", "instrument": "water_standpipe", "surface_level": 115.35, "northing": 5815939, "easting": 321897, "water_level": 116.88, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9186", "instrument": "water_standpipe", "surface_level": 76.33, "northing": 5811440, "easting": 316150, "water_level": 69.49, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5836", "instrument": "water_standpipe", "surface_level": 88.27, "northing": 5814934, "easting": 323334, "water_level": 86.53, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9883", "instrument": "water_standpipe", "surface_level": 80.73, "northing": 5813934, "easting": 318574, "water_level": 80.51, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4670", "instrument": "water_standpipe", "surface_level": 82.06, "northing": 5815365, "easting": 320938, "water_level": 76.48, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9935", "instrument": "water_standpipe", "surface_level": 81.63, "northing": 5813775, "easting": 318575, "water_level": 74.51, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5348", "instrument": "water_standpipe", "surface_level": 107.81, "northing": 5812269, "easting": 317313, "water_level": 103.79, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5534", "instrument": "water_standpipe", "surface_level": 111.09, "northing": 5812589, "easting": 323686, "water_level": 103.08, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-719", "instrument": "water_standpipe", "surface_level": 100.04, "northing": 5812468, "easting": 321552, "water_level": 98.93, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2613", "instrument": "water_standpipe", "surface_level": 100.55, "northing": 5813244, "easting": 317272, "water_level": 96.41, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2474", "instrument": "water_standpipe", "surface_level": 105.98, "northing": 5810491, "easting": 322968, "water_level": 105.53, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2585", "instrument": "water_standpipe", "surface_level": 77.97, "northing": 5815387, "easting": 321062, "water_level": 71.47, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9847", "instrument": "water_standpipe", "surface_level": 79.63, "northing": 5812150, "easting": 318247, "water_level": 74.96, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1242", "instrument": "water_standpipe", "surface_level": 87.96, "northing": 5813940, "easting": 323936, "water_level": 88.98, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2148", "instrument": "water_standpipe", "surface_level": 107.71, "northing": 5810649, "easting": 318568, "water_level": 106.16, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4206", "instrument": "water_standpipe", "surface_level": 114.83, "northing": 5810738, "easting": 316625, "water_level": 110.52, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4057", "instrument": "water_standpipe", "surface_level": 111.8, "northing": 5812824, "easting": 319177, "water_level": 102.51, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2510", "instrument": "water_standpipe", "surface_level": 115.4, "northing": 5813074, "easting": 319685, "water_level": 114.75, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9853", "instrument": "water_standpipe", "surface_level": 85.32, "northing": 5814821, "easting": 322302, "water_level": 75.39, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1041", "instrument": "water_standpipe", "surface_level": 99.41, "northing": 5815675, "easting": 317202, "water_level": 93.17, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4778", "instrument": "water_standpipe", "surface_level": 96.08, "northing": 5811143, "easting": 322238, "water_level": 97.13, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8556", "instrument": "water_standpipe", "surface_level": 81.74, "northing": 5810311, "easting": 317474, "water_level": 79.65, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8337", "instrument": "water_standpipe", "surface_level": 81.2, "northing": 5811190, "easting": 316831, "water_level": 78.87, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7720", "instrument": "water_standpipe", "surface_level": 102.42, "northing": 5814455, "easting": 321374, "water_level": 102.23, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5371", "instrument": "water_standpipe", "surface_level": 75.7, "northing": 5811314, "easting": 323745, "water_level": 69.22, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8476", "instrument": "water_standpipe", "surface_level": 84.1, "northing": 5812126, "easting": 323880, "water_level": 80.31, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9356", "instrument": "water_standpipe", "surface_level": 77.41, "northing": 5810270, "easting": 317505, "water_level": 73.11, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-4030", "instrument": "water_standpipe", "surface_level": 89.8, "northing": 5814729, "easting": 323159, "water_level": 86.33, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2750", "instrument": "water_standpipe", "surface_level": 117.42, "northing": 5811687, "easting": 319167, "water_level": 116.4, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3114", "instrument": "water_standpipe", "surface_level": 75.56, "northing": 5814903, "easting": 318415, "water_level": 71.71, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9503", "instrument": "water_standpipe", "surface_level": 81.6, "northing": 5814463, "easting": 322434, "water_level": 74.9, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1149", "instrument": "water_standpipe", "surface_level": 119.33, "northing": 5814747, "easting": 317188, "water_level": 119.41, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-6558", "instrument": "water_standpipe", "surface_level": 77.24, "northing": 5815308, "easting": 318803, "water_level": 71.09, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-2365", "instrument": "water_standpipe", "surface_level": 111.29, "northing": 5811873, "easting": 320884, "water_level": 108.63, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8250", "instrument": "water_standpipe", "surface_level": 106.81, "northing": 5815206, "easting": 323009, "water_level": 106.35, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-1668", "instrument": "water_standpipe", "surface_level": 80.38, "northing": 5811612, "easting": 318296, "water_level": 79.1, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-720", "instrument": "water_standpipe", "surface_level": 110.2, "northing": 5810959, "easting": 318691, "water_level": 102.61, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9838", "instrument": "water_standpipe", "surface_level": 118.17, "northing": 5814079, "easting": 320787, "water_level": 114.13, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3498", "instrument": "water_standpipe", "surface_level": 116.19, "northing": 5813056, "easting": 318947, "water_level": 106.4, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-7852", "instrument": "water_standpipe", "surface_level": 118.93, "northing": 5810788, "easting": 318117, "water_level": 119.18, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-8712", "instrument": "water_standpipe", "surface_level": 87.4, "northing": 5812176, "easting": 321981, "water_level": 79.24, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-3887", "instrument": "water_standpipe", "surface_level": 106.35, "northing": 5814143, "easting": 316187, "water_level": 100.81, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-9228", "instrument": "water_standpipe", "surface_level": 106.53, "northing": 5814992, "easting": 317737, "water_level": 97.3, "timestamp": "2022-04-25T00:45:18.447Z"}, {"borehole_number": "BH-5785", "instrument": "water_standpipe", "surface_level": 76.28, "northing": 5812052, "easting": 323452, "water_level": 71.73, "timestamp": "2022-04-25T00:45:18.447Z"}]}
//     """.stripMargin

//   val spark = 
//     SparkSession
//       .builder()
//       .appName("Stream Handler")
//       .master("local[*]")
//       .getOrCreate()

//   val innerSchema = StructType(Seq(
//     StructField("borehole_number", StringType),
//     StructField("instrument", StringType),
//     StructField("surface_level", FloatType),
//     StructField("northing", IntegerType),
//     StructField("easting", IntegerType),
//     StructField("water_level", FloatType),
//     StructField("timestamp", StringType)
//   ))

//   val schema = StructType(Seq(
//     StructField("request_type", StringType),
//     StructField("length", IntegerType),
//     StructField("RL_units", StringType),
//     StructField("timezone", StringType),
//     StructField("items", innerSchema)
//   ))

//   import spark.implicits._
//   val df = spark.read.json(Seq(sampleJson).toDS())
//   val dfFlatten = df
//     .select($"*", explode($"items") as "itemsFlattened").drop($"items")
//   val outputDF = dfFlatten
//     .select(
//       col("itemsFlattened").getItem("borehole_number").as("boreholeNumber"),
//       col("itemsFlattened").getItem("instrument").as("instrument"),
//       col("itemsFlattened").getItem("surface_level").as("surfaceLevel"),
//       col("itemsFlattened").getItem("northing").as("northing"),
//       col("itemsFlattened").getItem("easting").as("easting"),
//       col("itemsFlattened").getItem("water_level").as("waterLevel"),
//       col("itemsFlattened").getItem("timestamp").as("timestamp")
//     )
  
//   val outputDF1 = itemsDF
//     .withColumnRenamed("borehole_number", "boreholeNumber")
//     .withColumnRenamed("surface_level", "surfaceLevel")
//     .withColumnRenamed("water_level", "waterLevel")
//     .withColumnRenamed("borehole_number", "boreholeNumber")
//     .withColumnRenamed("timestamp", "ts")
// }